<div
    class="sm:inset-0 flex flex-col flex-auto min-w-0 sm:overflow-hidden bg-card dark:bg-transparent"
>
    <!-- <fuse-alert
        [appearance]="'soft'"
        class="w-full z-10 fixed"
        [dismissible]="true"
        [dismissed]="false"
        [name]="'assignAlert'"
        [type]="'success'"
    >
        <span fuseAlertTitle>Success</span>
        {{ assignText }}
    </fuse-alert> -->
    <div class="page-title justify-between flex">
        {{ "MosqueProfile.registeredMosques" | translate }}
        <div class="page-sub-title">
            <a class="mr-1 text-xl">{{ pageLength }}</a>
            <span class="float-right">
                {{ "MosqueProfile.totalMosques" | translate }}
            </span>
        </div>
    </div>

    <div
        class="flex flex-col sm:flex-row flex-0 sm:items-center sm:justify-between pb-4 px-6 md:px-4"
    >
        <div class="absolute inset-x-0 bottom-0" *ngIf="isLoading">
            <mat-progress-bar [mode]="'indeterminate'"></mat-progress-bar>
        </div>
        <div class="">
            <!-- <mat-form-field class="fuse-mat-dense fuse-mat-rounded min-w-64" [subscriptSizing]="'dynamic'">
                <mat-label>{{'RegUsers.search' | translate}}</mat-label>
                <mat-icon class="icon-size-5" matPrefix [svgIcon]="'heroicons_solid:search'"></mat-icon>
                <input matInput [formControl]="searchInputControl" [autocomplete]="'off'"
                    (keyup)="applyFilter($event.target.value)" placeholder="{{'RegUsers.search' | translate}}">
            </mat-form-field> -->
            <form [formGroup]="searchForm">
                <mat-form-field
                    class="fuse-mat-dense fuse-mat-rounded min-w-40 ml-2 mr-2"
                    [subscriptSizing]="'dynamic'"
                >
                    <mat-label>{{"MosqueProfile.mosqueName" | translate}}</mat-label>
                    <input
                        matInput
                        formControlName="mosqueName"
                        [autocomplete]="'off'"
                        placeholder="{{ 'MosqueProfile.mosqueName' | translate }}"
                        maxlength="20"
                    />
                </mat-form-field>
                <mat-form-field
                    class="fuse-mat-dense fuse-mat-rounded min-w-40 ml-2 mr-2"
                    [subscriptSizing]="'dynamic'"
                >
                    <mat-label>{{"MosqueProfile.status" | translate}}</mat-label>
                    <mat-select
                        formControlName="mosqueStatus"
                        [disableOptionCentering]="true"
                    >
                        <mat-option [value]="true">Active</mat-option>
                        <mat-option [value]="false">Inactive</mat-option>
                    </mat-select>
                </mat-form-field>
            </form>
        </div>
        <div class="flex shrink-0 items-center mt-6 sm:mt-0">
            <button
                mat-flat-button
                [color]="'primary'"
                class="mr-2"
                (click)="SearchFilter()"
            >
                <span class="ml-2 mr-1">{{
                    "RegUsers.search" | translate
                }}</span>
            </button>
            <button
                mat-flat-button
                (click)="ResetList()"
                style="background: beige"
            >
                <span class="ml-2 mr-1">{{
                    "RegUsers.reset" | translate
                }}</span>
            </button>
        </div>
        <div class="flex shrink-0 items-center mt-6 sm:mt-0">
            <ng-container
                *ngFor="let action of currentActions?.childMenuActions"
            >
                <button
                    *ngIf="action?.actionNameId === 'Add'"
                    mat-flat-button
                    [color]="'primary'"
                    (click)="addMosque()"
                >
                    <span class="ml-2 mr-1">{{
                        "MosqueProfile.addMosque" | translate
                    }}</span>
                </button>
            </ng-container>
        </div>
        <!-- <div class="">
            <mat-form-field class="w-full" [subscriptSizing]="'dynamic'">
                <mat-label>{{ "MosqueProfile.search" | translate }}</mat-label>
                <mat-icon
                    matPrefix
                    [svgIcon]="'heroicons_solid:search'"
                ></mat-icon>
                <input
                    matInput
                    [formControl]="searchInputControl"
                    (keyup)="applyFilter($event.target.value)"
                    [autocomplete]="'off'"
                    placeholder="{{ 'MosqueProfile.search' | translate }}"
                />
            </mat-form-field>
        </div> -->
        <!-- <div class="flex shrink-0 items-center mt-6 sm:mt-0">
            <ng-container
                *ngFor="let action of currentActions?.childMenuActions"
            >
                <button
                    *ngIf="action?.actionNameId === 'Add'"
                    mat-flat-button
                    [color]="'primary'"
                    (click)="addMosque()"
                >
                    <span class="ml-2 mr-1">{{
                        "MosqueProfile.addMosque" | translate
                    }}</span>
                </button>
            </ng-container>
        </div> -->
    </div>
    <div class="flex flex-auto overflow-hidden">
        <div
            class="flex flex-col flex-auto overflow-hidden sm:overflow-y-auto sm:justify-between px-6 md:px-4"
        >
            <table mat-table [dataSource]="dataSource">
                <ng-container matColumnDef="mosqueName">
                    <th mat-header-cell *matHeaderCellDef>
                        {{ "MosqueProfile.mosqueName" | translate }}
                    </th>
                    <td mat-cell *matCellDef="let element">
                        <a
                            class="flex"
                            (click)="launchMosque(element.mosqueContactGuid)"
                            ><img
                                class="w-4 h-4 mt-1"
                                [ngClass]="
                                    direction === 'ltr'
                                        ? 'mr-1 '
                                        : direction === 'rtl'
                                        ? 'ml-1 '
                                        : ''
                                "
                                [src]="imageEndPoints?.browseIcon"
                            />
                            {{ element.mosqueName }}
                        </a>
                    </td>
                </ng-container>

                <ng-container matColumnDef="mosqueAddress">
                    <th mat-header-cell *matHeaderCellDef>
                        {{ "MosqueProfile.location" | translate }}
                    </th>
                    <td mat-cell *matCellDef="let element">
                        <div>{{ element?.mosqueLocation }}</div>
                        <!-- <div class="text-sm text-disabled">
                            {{ element.mosqueCity }}
                        </div> -->
                    </td>
                </ng-container>

                <ng-container matColumnDef="mosqueContactNumber">
                    <th mat-header-cell *matHeaderCellDef>
                        {{ "MosqueProfile.contactNumber" | translate }}
                    </th>
                    <td mat-cell *matCellDef="let element">
                        {{ element.mobileNumber }}
                    </td>
                </ng-container>

                <ng-container matColumnDef="adminName">
                    <th mat-header-cell *matHeaderCellDef>
                        {{ "MosqueProfile.adminName" | translate }}
                    </th>
                    <td mat-cell *matCellDef="let element">
                        <span
                            (click)="assignAdmin(element)"
                            class="cursor-pointer"
                            [ngClass]="
                                !element?.adminName
                                    ? 'text-danger'
                                    : element?.adminName === 'Not Assigned'
                                    ? 'text-danger'
                                    : ''
                            "
                        >
                            {{
                                element?.adminName
                                    ? element.adminName
                                    : "Not Assigned"
                            }}</span
                        >
                    </td>
                </ng-container>

                <ng-container matColumnDef="createdOn">
                    <th mat-header-cell *matHeaderCellDef>
                        {{ "MosqueProfile.createdDate" | translate }}
                    </th>
                    <td mat-cell *matCellDef="let element">
                        <div>{{ element.createdOn | date : "dd/MM/yyyy" }}</div>
                        <div class="text-sm text-disabled">
                            {{ element?.createdOn | date : "shortTime" }}
                        </div>
                    </td>
                </ng-container>

                <ng-container matColumnDef="mosqueStatus">
                    <th mat-header-cell *matHeaderCellDef>
                        {{ "MosqueProfile.status" | translate }}
                    </th>
                    <td mat-cell *matCellDef="let element">
                        <span class="flex cursor-pointer">
                            <img
                                class="w-4 h-4 mt-1"
                                [ngClass]="
                                    direction === 'ltr'
                                        ? 'mr-1 '
                                        : direction === 'rtl'
                                        ? 'ml-1'
                                        : ''
                                "
                                [src]="
                                    element?.mosqueStatus === false
                                        ? imageEndPoints?.deactive
                                        : imageEndPoints?.activeIcon
                                "
                            />
                            <span
                                [ngClass]="
                                    element?.mosqueStatus === false
                                        ? ''
                                        : element.mosqueStatus
                                        ? 'active'
                                        : ''
                                "
                                >{{
                                    element.mosqueStatus ? "Active" : "Inactive"
                                }}</span
                            >
                        </span>
                    </td>
                </ng-container>

                <ng-container matColumnDef="mosqueEmail">
                    <th mat-header-cell *matHeaderCellDef>
                        {{ "MosqueProfile.emailID" | translate }}
                    </th>
                    <td mat-cell *matCellDef="let element">
                        <a href="mailto:{{ element.email }}">
                            {{ element.email }}</a
                        >
                    </td>
                </ng-container>

                <ng-container matColumnDef="actions">
                    <th mat-header-cell *matHeaderCellDef></th>
                    <td
                        mat-cell
                        *matCellDef="let element"
                        class="pr-0 pl-0 w-4"
                    >
                        <!-- Add a button to trigger the menu -->
                        <button
                            style="padding-right: revert"
                            [matMenuTriggerFor]="menu"
                        >
                            <mat-icon>more_vert</mat-icon>
                        </button>
                        <!-- Define the menu -->
                        <mat-menu
                            #menu="matMenu"
                            [ngClass]="
                                direction === 'ltr'
                                    ? 'left-4 '
                                    : direction === 'rtl'
                                    ? 'right-4'
                                    : ''
                            "
                        >
                            <ng-container
                                *ngFor="
                                    let action of currentActions?.childMenuActions
                                "
                            >
                                <button
                                    mat-menu-item
                                    (click)="assignAdmin(element)"
                                    *ngIf="
                                        element?.mosqueStatus &&
                                        action?.actionNameId === 'Assign'
                                    "
                                >
                                    {{ "MosqueProfile.assignRole" | translate }}
                                </button>
                                <button
                                    mat-menu-item
                                    (click)="editMosque(element)"
                                    *ngIf="action?.actionNameId === 'Edit'"
                                >
                                    {{ "MosqueProfile.editMosque" | translate }}
                                </button>
                                <button
                                    mat-menu-item
                                    (click)="shareSiteUri(element)"
                                    *ngIf="action?.actionNameId === 'Share'"
                                >
                                    {{ "MosqueProfile.shareSite" | translate }}
                                </button>
                                <button
                                    mat-menu-item
                                    (click)="
                                        confirmDeactiveMosque(
                                            element,
                                            'Inactive'
                                        )
                                    "
                                    *ngIf="
                                        element?.mosqueStatus &&
                                        action?.actionNameId === 'Deactivate'
                                    "
                                    class="text-danger"
                                >
                                    <span class="text-danger">
                                        {{
                                            "MosqueProfile.deactivate"
                                                | translate
                                        }}
                                    </span>
                                </button>
                                <button
                                    mat-menu-item
                                    (click)="
                                        confirmDeactiveMosque(element, 'Active')
                                    "
                                    *ngIf="
                                        !element?.mosqueStatus &&
                                        action?.actionNameId === 'Activate'
                                    "
                                    class="text-primary"
                                >
                                    <span class="text-primary">
                                        {{
                                            "MosqueProfile.activate" | translate
                                        }}
                                    </span>
                                </button>
                            </ng-container>
                        </mat-menu>
                    </td>
                </ng-container>
                <tr
                    mat-header-row
                    *matHeaderRowDef="displayedColumns; sticky: true"
                ></tr>
                <tr
                    mat-row
                    *matRowDef="let row; columns: displayedColumns"
                ></tr>

                <tr class="mat-row" *matNoDataRow>
                    <td class="mat-cell" colspan="4">
                        {{ "MosqueProfile.noDataMatching" | translate }}
                    </td>
                </tr>
            </table>           
            <mat-paginator #paginator [length]="pageLength" [pageSize]="pageSize" [showFirstLastButtons]="true"
                showFirstLastButtons [pageSizeOptions]="[10,20, 50]" (page)="onPageChange($event)">
            </mat-paginator>
        </div>
    </div>
</div>
